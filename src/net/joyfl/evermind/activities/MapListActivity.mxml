<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
		xmlns:s="library://ns.adobe.com/flex/spark"
		xmlns:e="net.joyfl.evermind.components.*"
		title="Evermind" initialize="init()">
	<fx:Script>
		<![CDATA[
			import mx.collections.ArrayList;
			
			import net.joyfl.evermind.events.EvermindEvent;
			import net.joyfl.evermind.loader.MapLoader;
			import net.joyfl.evermind.models.MapMetadata;
			
			[Bindable]
			private var maps : ArrayList = new ArrayList();
			
			private var _loader : MapLoader = new MapLoader();
			
			private function init() : void
			{
				_loader.addEventListener( EvermindEvent.LIST_MAPS, onListMaps );
				_loader.listMaps();
			}
			
			private function onListMaps( e : EvermindEvent ) : void
			{
				for( var i : int = 0; i < e.data.length; i++ )
				{
					maps.addItem( e.data[i] );
				}
			}
			
			private function onMapListClick( e : MouseEvent ) : void
			{
				var mapList : List = e.currentTarget as List;
				var mapItem : MapMetadata = mapList.selectedItem as MapMetadata;
				if( mapItem )
					navigator.pushView( MapEditorActivity, mapItem );
			}
			
			private function onAddButtonClick( e : MouseEvent ) : void
			{
				trace( "Add" );
			}
			
			private function onAlignButtonClick( e : MouseEvent ) : void
			{
				trace( "Align" );
			}
			
			private function onSearchButtonClick( e : MouseEvent ) : void
			{
				trace( "Search" );
			}
			
			private function onOverflowButtonClick( e : MouseEvent ) : void
			{
				trace( "Overflow" );
			}
		]]>
	</fx:Script>
	
	<s:layout>
		<s:VerticalLayout gap="0" />
	</s:layout>
	
	<s:List width="100%" height="100%"
			dataProvider="{maps}" itemRenderer="net.joyfl.evermind.renderers.MapListItemRenderer"
			click="onMapListClick(event)"
			contentBackgroundColor="#F2F2F2" />
	<s:Line width="100%">
		<s:stroke>
			<s:SolidColorStroke color="#999999" caps="square" />
		</s:stroke>
	</s:Line>
	
	<!-- 하단 액션바 -->
	<s:Group width="100%" height="72">
		<s:Rect width="100%" height="100%">
			<s:fill>
				<s:SolidColor color="#DDDDDD" />
			</s:fill>
		</s:Rect>
		
		<s:HGroup left="10" right="10" height="72" verticalCenter="0" horizontalAlign="left" gap="20">
			<e:ActionBarButton left="10" image="@Embed('/../res/button_add.png')" backgroundImage="@Embed('/../res/bottom_actionbar_button_bg.png')" click="onAddButtonClick( event )" />
		</s:HGroup>
		
		<s:HGroup left="10" right="10" height="72" verticalCenter="0" horizontalAlign="right" gap="20">
			<e:ActionBarButton image="@Embed('/../res/button_align.png')" backgroundImage="@Embed('/../res/bottom_actionbar_button_bg.png')" click="onAlignButtonClick( event )" />
			<e:ActionBarButton image="@Embed('/../res/button_search.png')" backgroundImage="@Embed('/../res/bottom_actionbar_button_bg.png')" click="onSearchButtonClick( event )" />
			<e:ActionBarButton image="@Embed('/../res/button_overflow.png')" backgroundImage="@Embed('/../res/bottom_actionbar_button_bg.png')" click="onOverflowButtonClick( event )" />
		</s:HGroup>
	</s:Group>
</s:View>
